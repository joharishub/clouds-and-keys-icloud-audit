<!--
Clouds & Keys — Guided iCloud Security Review v26
© 2025 Clouds & Keys. All rights reserved. Self-contained, no external deps.
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clouds & Keys — Guided iCloud Security Review (v2.3)</title>
<style>
  :root{
    --ck-blue:#2563EB; --ck-blue2:#3882F6;
    --ck-green:#16A34A; --ck-amber:#D97706; --ck-red:#DC2626;
    --ck-gray:#6B7280; --ck-bg:#F8FAFC; --ck-border:#E5E7EB;
  }
  body{margin:0;background:#F8FAFC;font-family:ui-sans-serif,system-ui,-apple-system,"SF Pro Text",Inter,Arial,Helvetica,sans-serif;color:#111827}
  #ck-wizard .wrap{max-width:860px;margin:24px auto;padding:16px}
  .card{background:#fff;border:1px solid var(--ck-border);border-radius:16px;padding:20px;box-shadow:0 1px 2px rgba(0,0,0,.05)}
  h1{font-size:22px;margin:0 0 8px;color:#0F172A}
  h3{font-size:18px;margin:0 0 6px;color:#111827}
  p{margin:0 0 12px;line-height:1.5}
  .muted{color:var(--ck-gray)}
  .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid transparent;border-radius:999px;padding:10px 14px;font-size:14px;font-weight:600;background:#fff;cursor:pointer;transition:.2s all}
  .btn-primary{background:var(--ck-blue);color:#fff}
  .btn-ghost{color:#111827;border-color:var(--ck-border)}
  .btn:disabled{opacity:.55;cursor:not-allowed}
  .topbar{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap}
  .progress{height:8px;width:100%;background:#E5E7EB;border-radius:999px;overflow:hidden;transition:background .5s ease}
  .progress > i{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--ck-blue),var(--ck-blue2));transition:width .25s ease}
  .notes{font-size:13px;color:var(--ck-gray);margin-top:6px}
  .action{background:#F9FAFB;border:1px solid var(--ck-border);border-radius:12px;padding:12px;margin:12px 0}
  .action p{margin:0;color:var(--ck-blue);font-weight:600}
  .detail{margin:10px 0 12px}
  /* Keep image area stable across steps (prevents card resizing / page jumping on mobile) */
  .step-img{
    display:block;
    width:100%;
    height:340px;              /* fixed space so each step doesn't reflow */
    max-width:100%;
    margin:10px auto 12px;
    object-fit:contain;
    border-radius:12px;
    background:#fff;
    box-shadow:0 2px 6px rgba(0,0,0,0.10);
  }
  /* Reserve space so steps with shorter text don't shrink the card dramatically */
  #stepArea{min-height:640px}
  @media(max-width:520px){ #stepArea{min-height:560px} }
  .foot{display:flex;justify-content:space-between;align-items:center;margin-top:16px}
  .hidden{display:none!important}
  .badge{display:inline-flex;align-items:center;gap:10px;padding:8px 12px;border-radius:8px;font-weight:700;border:1px solid var(--ck-border)}
  .badge.minimal{background:#ECFDF5;color:#065F46}
  .badge.low{background:#FFFBEB;color:#92400E}
  .badge.high{background:#FEF2F2;color:#991B1B}
  /* Drawer */
  .drawer-mask{position:fixed;inset:0;background:rgba(17,24,39,.35);backdrop-filter:blur(1px);opacity:0;pointer-events:none;transition:opacity .2s}
  .drawer-mask.open{opacity:1;pointer-events:auto}
  .drawer{position:fixed;top:0;right:-360px;width:340px;max-width:86vw;height:100%;background:#fff;border-left:1px solid var(--ck-border);box-shadow:-8px 0 24px rgba(0,0,0,.08);transition:right .25s;display:flex;flex-direction:column}
  .drawer.open{right:0}
  .drawer-head{padding:14px 16px;border-bottom:1px solid var(--ck-border);display:flex;align-items:center;justify-content:space-between}
  .drawer-title{font-weight:800}
  .drawer-body{padding:10px 0 14px;overflow:auto}
  .mini{font-size:13px;color:var(--ck-gray)}
  .row{display:flex;align-items:center;gap:10px;padding:10px 16px;border-bottom:1px solid #F3F4F6;cursor:pointer}
  .row:hover{background:#F9FAFB}
  .status{width:10px;height:10px;border-radius:50%;border:1px solid var(--ck-border)}
  .status.enabled{background:var(--ck-green);border-color:var(--ck-green)}
  .status.skipped{background:#9CA3AF;border-color:#9CA3AF}
  .row-title{font-size:14px;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  /* Amber flash when skipping */
  .progress.flash{background:#FDE68A!important}
  @media(max-width:520px){
    .btn{padding:8px 12px}
    .step-img{height:260px}
  }
</style>
</head>
<body>
<div id="ck-wizard">
  <div class="wrap">
    <!-- Landing -->
    <div id="landing" class="card" style="text-align:center;">
      <h1>Guided iCloud Security Review</h1>
      <p class="muted">Work through each setting. Mark it <strong>Enabled</strong> if it matches your iPhone, or <strong>Skip</strong> to move on. You’ll get a risk badge and summary at the end.</p>
      <button id="beginBtn" class="btn btn-primary">Begin Review</button>
    </div>

    <!-- Wizard -->
    <div id="wizard" class="card hidden">
      <div class="topbar">
        <div style="flex:1 1 380px;min-width:260px;">
          <div class="progress" id="progressTop"><i id="bar"></i></div>
          <p class="notes" id="progressNote">Step 1 of 20</p>
        </div>
        <div style="display:flex;gap:8px;align-items:flex-start;">
          <button id="openDrawer" class="btn btn-ghost">View Progress</button>
        </div>
      </div>

      <div id="stepArea" style="margin-top:16px;">
        <h3 id="stepTitle"></h3>
        <p id="detail" class="detail muted"></p>
        <img id="stepImage" class="step-img" alt="" src="" onerror="this.style.visibility='hidden'; this.style.opacity='1';"/>
        <div class="action"><p id="action"></p></div>

        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button id="markEnabled" class="btn btn-primary">Mark as Enabled</button>
          <button id="skip" class="btn btn-ghost">Skip</button>
        </div>
        <div class="foot">
          <button id="back" class="btn btn-ghost">Back</button>
        </div>
      </div>

      <div id="confirm" class="hidden" style="margin-top:16px;text-align:center;">
        <h1>Submit Review</h1>
        <p class="muted">You’ve reached the end. Review your progress or generate your summary.</p>
        <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:10px;">
          <button id="openDrawerConfirm" class="btn btn-ghost">Review Progress</button>
          <button id="generateSummary" class="btn btn-primary">Generate Summary</button>
        </div>
      </div>

      <div id="summary" class="hidden" style="margin-top:16px;">
        <h1 style="margin-top:0;">Review Summary</h1>
        <div id="riskBadge" class="badge minimal">Minimal Risk</div>
        <p id="summaryContext" class="muted" style="margin-top:8px;font-weight:500;"></p>

        <div class="card" style="margin-top:12px;">
          <h3>Enabled Protections</h3>
          <ul id="enabledList"></ul>
        </div>
        <div class="card" style="margin-top:12px;">
          <h3>Skipped</h3>
          <ul id="missingList"></ul>
        </div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;">
          <button id="restart" class="btn btn-ghost">New Review</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Drawer -->
  <div id="drawerMask" class="drawer-mask"></div>
  <aside id="drawer" class="drawer" aria-label="Progress drawer">
    <div class="drawer-head">
      <div class="drawer-title">Your Progress</div>
      <button id="closeDrawer" class="btn btn-ghost">Close</button>
    </div>
    <div class="drawer-body">
      <div class="card" style="border-radius:0;border-left:0;border-right:0;">
        <div class="progress"><i id="drawerBar"></i></div>
        <p class="mini" id="drawerProgressNote" style="margin:6px 0 0;">0% complete</p>
        <p class="mini" id="drawerCounts" style="margin:4px 0 0;">Enabled 0 • Skipped 0</p>
        <p class="mini" id="drawerRisk" style="margin:4px 0 0;">Risk so far: —</p>
      </div>
      <div id="drawerList"></div>
    </div>
  </aside>
</div>

<script>
(function(){
  // ========= Protections (20) with content + weights =========
  // v2.1 category multipliers: Account .40, Device .35, System .15, Web .10
  const protections = [
    // Account Protection
    {id:"emails", cat:"Account Protection", sev:"critical",
     title:"Emails & Phone Numbers",
     why:"Your Apple ID recovery depends on these being current. If they’re wrong, you may be locked out when you need them most.",
     action:"Settings → [your name] → Sign-In & Security → Verify Emails & Phone Numbers",
     img:"images/01.png", weight:3, mult:.40},
    {id:"twofa", cat:"Account Protection", sev:"critical",
     title:"Two-Factor Authentication & Trusted Devices",
     why:"Two-factor authentication prevents sign-ins without your approval, even if someone knows your password.",
     action:"Settings → [your name] → Sign-In & Security → Two-Factor Authentication → ON + Verify Trusted Phone Numbers and Devices",
     img:"images/02.png", weight:3, mult:.40},
    {id:"keys", cat:"Account Protection", sev:"high",
     title:"Security Keys",
     why:"Security keys block phishing by requiring a physical key to sign in. Without it, your Apple ID cannot be accessed.",
     action:"Settings → [your name] → Sign-In & Security → Two-Factor Authentication → Security Keys → Add Security Keys",
     img:"images/03.png", weight:2, mult:.40},
    {id:"rcontacts", cat:"Account Protection", sev:"low",
     title:"Recovery Contacts",
     why:"Recovery contacts can help you regain access if you’re locked out, without seeing your data.",
     action:"Settings → [your name] → Sign-In & Security → Recovery Contacts → Add Recovery Contact",
     img:"images/04.png", weight:1, mult:.40},
    {id:"rkey", cat:"Account Protection", sev:"critical",
     title:"Recovery Key",
     why:"A recovery key gives you full control over account recovery if you lose access to your password or devices.",
     action:"Settings → [your name] → Sign-In & Security → Recovery Key → On / Create New",
     img:"images/05.png", weight:3, mult:.40},
    {id:"adp", cat:"Account Protection", sev:"high",
     title:"Advanced Data Protection",
     why:"Advanced Data Protection encrypts most iCloud data so only your devices can access it — not even Apple.",
     action:"Settings → [your name] → iCloud → Advanced Data Protection → On",
     img:"images/06.png", weight:2, mult:.40},
    {id:"icloudWeb", cat:"Account Protection", sev:"high",
     title:"Access iCloud Data on the Web",
     why:"Disabling web access removes the ability for an attacker to sign in at iCloud.com. Leave this off unless you need it.",
     action:"Settings → [your name] → iCloud → Access iCloud Data on the Web → Off",
     img:"images/07.png", weight:2, mult:.40},

    // Device Protection
    {id:"backup", cat:"Device Protection", sev:"critical",
     title:"iCloud Backup",
     why:"iCloud Backup ensures your data can be restored after loss, theft, or device replacement.",
     action:"Settings → [your name] → iCloud → iCloud Backup → Back Up This iPhone → On",
     img:"images/08.png", weight:3, mult:.35},
    {id:"findmy", cat:"Device Protection", sev:"critical",
     title:"Find My iPhone",
     why:"Find My lets you locate, lock, or erase your device if it’s lost or stolen.",
     action:"Settings → [your name] → Find My → Find My iPhone → Turn on Find My iPhone, Find My network, and Send Last Location",
     img:"images/09.png", weight:3, mult:.35},
    {id:"updates", cat:"Device Protection", sev:"critical",
     title:"Automatic Updates",
     why:"Automatic updates install Apple’s latest security fixes without requiring manual checks.",
     action:"Settings → General → Software Update → Automatic Updates → Automatically Install",
     img:"images/10.png", weight:3, mult:.35},
    {id:"airdrop", cat:"Device Protection", sev:"high",
     title:"AirDrop",
     why:"Disabling AirDrop prevents nearby strangers from sending files or requests to your device.",
     action:"Settings → General → AirDrop → Receiving Off or Contacts Only",
     img:"images/11.png", weight:2, mult:.35},
    {id:"vpnmdm", cat:"Device Protection", sev:"high",
     title:"VPN & Device Management Review",
     why:"Reviewing profiles ensures no hidden settings control your device behavior.",
     action:"Settings → General → VPN & Device Management → Remove unfamiliar profiles",
     img:"images/12.png", weight:2, mult:.35},
    {id:"attention", cat:"Device Protection", sev:"low",
     title:"Require Attention for Face ID",
     why:"Ensure your phone unlocks only when you are actively looking at it.",
     action:"Settings → Face ID & Passcode → Require Attention for Face ID → On",
     img:"images/13.png", weight:1, mult:.35},
    {id:"stolen", cat:"Device Protection", sev:"high",
     title:"Stolen Device Protection",
     why:"Delay a thief that has the device passcode from changing critical settings. This gives you time to mark the device as lost in Find My.",
     action:"Settings → Face ID & Passcode → Stolen Device Protection → On",
     img:"images/14.png", weight:2, mult:.35},
    {id:"passcode", cat:"Device Protection", sev:"critical",
     title:"Require Passcode",
     why:"Your passcode locks your device and encrypts stored data. Without it, all other protections are weakened.",
     action:"Settings → Face ID & Passcode → Require Passcode → Immediately",
     img:"images/15.png", weight:3, mult:.35},
    {id:"erase10", cat:"Device Protection", sev:"critical",
     title:"Erase Data after 10 Failed Attempts",
     why:"This setting erases the device after multiple failed passcode attempts, stopping brute-force attacks.",
     action:"Settings → Face ID & Passcode → Erase Data → On",
     img:"images/16.png", weight:3, mult:.35},

    // System & Privacy
    {id:"safety", cat:"System & Privacy Controls", sev:"high",
     title:"Safety Check",
     why:"Safety Check allows you to review and instantly reset sharing and privacy permissions for people and apps.",
     action:"Settings → Privacy & Security → Safety Check → Select Manage Sharing & Access",
     img:"images/17.png", weight:2, mult:.15},
    {id:"wired", cat:"System & Privacy Controls", sev:"high",
     title:"Wired Accessories",
     why:"Block forensic tools and malicious chargers from reading data through the Lightning or USB-C port.",
     action:"Settings → Privacy & Security → Wired Accessories → Ask for New Accessories",
     img:"images/18.png", weight:2, mult:.15},

    // Safe Browsing (Apps → Safari)
    {id:"fraudWarn", cat:"Safe Browsing", sev:"low",
     title:"Fraudulent Website Warning",
     why:"Safari warns you before visiting known phishing or malicious websites.",
     action:"Settings → Apps → Safari → Fraudulent Website Warning → On",
     img:"images/19.png", weight:1, mult:.10},
    {id:"notSecure", cat:"Safe Browsing", sev:"low",
     title:"Not Secure Connection Warning",
     why:"This alert warns when a website doesn’t encrypt your data.",
     action:"Settings → Apps → Safari → Show Not Secure Warnings → On",
     img:"images/20.png", weight:1, mult:.10}
  ];

  // ========= State & Elements =========
  let idx = 0;
  const state = Object.fromEntries(protections.map(p => [p.id, null])); // 'enabled' | 'skipped' | null
  const landing=document.getElementById('landing'), wizard=document.getElementById('wizard');
  const beginBtn=document.getElementById('beginBtn'), bar=document.getElementById('bar');
  const progressTop=document.getElementById('progressTop'), progressNote=document.getElementById('progressNote');
  const stepArea=document.getElementById('stepArea'), stepTitle=document.getElementById('stepTitle');
  const detailEl=document.getElementById('detail'), actionEl=document.getElementById('action');
  const stepImg=document.getElementById('stepImage');
  const markEnabled=document.getElementById('markEnabled'), skip=document.getElementById('skip'), back=document.getElementById('back');
  const confirmView=document.getElementById('confirm'), summary=document.getElementById('summary');
  const enabledList=document.getElementById('enabledList'), missingList=document.getElementById('missingList');
  const riskBadge=document.getElementById('riskBadge');

  // Drawer
  const drawer=document.getElementById('drawer'), drawerMask=document.getElementById('drawerMask');
  const openDrawer=document.getElementById('openDrawer'), closeDrawer=document.getElementById('closeDrawer');
  const openDrawerConfirm=document.getElementById('openDrawerConfirm'), drawerList=document.getElementById('drawerList');
  const drawerBar=document.getElementById('drawerBar'), drawerProgressNote=document.getElementById('drawerProgressNote');
  const drawerCounts=document.getElementById('drawerCounts'), drawerRisk=document.getElementById('drawerRisk');

  // ========= Risk Logic =========
  function computeRisk(){
    const anyCriticalMissing = protections.some(p => p.sev==='critical' && state[p.id]!=='enabled');
    const total = protections.reduce((a,p)=>a + p.weight*p.mult, 0);
    let enabled = protections.reduce((a,p)=>a + (state[p.id]==='enabled' ? p.weight*p.mult : 0), 0);
    if (state['keys']==='enabled') enabled += 0.20; // bonus
    const pct = enabled/total;
    let level;
    if (anyCriticalMissing) level='High Risk';
    else if (pct>=0.90) level='Minimal Risk';
    else if (pct>=0.70) level='Low Risk';
    else level='High Risk';
    return {level, pct};
  }

  function setRiskBadge(el, level){
    el.classList.remove('minimal','low','high');
    if (level==='High Risk') el.classList.add('high');
    else if (level==='Low Risk') el.classList.add('low');
    else el.classList.add('minimal');
    el.textContent = level;
  }

  // ========= UI =========
  function updateProgressUI(){
    const pct = Math.round((Math.min(idx, protections.length)/protections.length)*100);
    bar.style.width = pct + '%';
    progressNote.textContent = `Step ${Math.min(idx+1, protections.length)} of ${protections.length}`;
    // drawer
    drawerBar.style.width = pct + '%';
    drawerProgressNote.textContent = `${pct}% complete`;
    const en = Object.values(state).filter(v=>v==='enabled').length;
    const sk = Object.values(state).filter(v=>v==='skipped').length;
    drawerCounts.textContent = `Enabled ${en} • Skipped ${sk}`;
    drawerRisk.textContent = `Risk so far: ${computeRisk().level}`;
  }

  function renderDrawerList(){
    drawerList.innerHTML='';
    protections.forEach((p,i)=>{
      const row=document.createElement('div'); row.className='row';
      row.onclick=()=>{ idx=i; closeProgressDrawer(); showStep(); window.scrollTo({top:0,behavior:'smooth'}); };
      const dot=document.createElement('i'); dot.className='status ' + (state[p.id]||'skipped');
      const title=document.createElement('div'); title.className='row-title'; title.textContent=`${i+1}. ${p.title}`;
      row.appendChild(dot); row.appendChild(title); drawerList.appendChild(row);
    });
  }

  function openProgressDrawer(){ renderDrawerList(); updateProgressUI(); drawer.classList.add('open'); drawerMask.classList.add('open'); }
  function closeProgressDrawer(){ drawer.classList.remove('open'); drawerMask.classList.remove('open'); }

  function showStep(){
    if(idx>=protections.length){ stepArea.classList.add('hidden'); confirmView.classList.remove('hidden'); updateProgressUI(); return; }
    confirmView.classList.add('hidden'); stepArea.classList.remove('hidden');
    const p = protections[idx];
    stepTitle.textContent = p.title;
    detailEl.innerHTML = `<div class="muted" style="margin-bottom:6px;">${p.cat} • ${p.sev[0].toUpperCase()+p.sev.slice(1)}</div>
    <p style="margin-top:0;color:#111827;">${p.why}</p>`;
    actionEl.textContent = p.action;
    // image fade
    stepImg.style.opacity = 0; stepImg.style.display='block'; stepImg.style.visibility='visible';
    stepImg.onload=()=>{ stepImg.style.opacity=1; };
    stepImg.onerror=()=>{ stepImg.style.opacity=1; stepImg.style.visibility='hidden'; };
    stepImg.src = p.img || '';
    stepImg.alt = p.title;
    back.disabled = (idx===0);
    updateProgressUI();
  }

  function showSummary(){
    const enabled = protections.filter(p=>state[p.id]==='enabled');
    const missing = protections.filter(p=>state[p.id]!=='enabled');
    enabledList.innerHTML = enabled.map(p=>`<li>${p.title}</li>`).join('');
    missingList.innerHTML = missing.map(p=>`<li>${p.title}</li>`).join('');

    const {level} = computeRisk();
    setRiskBadge(riskBadge, level);

    // Set summary context line based on risk level
    const context = document.getElementById('summaryContext');
    if(level === 'Minimal Risk'){
      context.textContent = 'Your account and devices are well protected. Keep software and backups up to date to maintain this level.';
    } else if(level === 'Low Risk'){
      context.textContent = 'Most key protections are in place, but a few settings could be improved for stronger security.';
    } else {
      context.textContent = 'Several important protections are missing. Review skipped items to reduce your exposure to account or data compromise.';
    }

    // Hide progress UI + drawer button on summary
    openDrawer.classList.add('hidden'); // Hide “View Progress” on summary
    progressTop.classList.add('hidden');  // <— hide bar
    progressNote.classList.add('hidden'); // <— hide "Step X of Y"

    stepArea.classList.add('hidden');
    confirmView.classList.add('hidden');
    summary.classList.remove('hidden');
    window.scrollTo({top:0,behavior:'smooth'});
  }

  // ========= Events =========
  beginBtn.addEventListener('click', ()=>{ landing.classList.add('hidden'); wizard.classList.remove('hidden'); showStep(); });
  markEnabled.addEventListener('click', ()=>{ state[protections[idx].id]='enabled'; idx++; showStep(); });
  skip.addEventListener('click', ()=>{
    state[protections[idx].id]='skipped';
    // amber flash on progress bar
    progressTop.classList.add('flash'); setTimeout(()=>progressTop.classList.remove('flash'),600);
    idx++; showStep();
  });
  back.addEventListener('click', ()=>{ if(idx>0){ idx--; showStep(); }});
  document.getElementById('generateSummary').addEventListener('click', showSummary);
  document.getElementById('restart').addEventListener('click', ()=>location.reload());
  openDrawer.addEventListener('click', openProgressDrawer);
  openDrawerConfirm?.addEventListener('click', openProgressDrawer);
  closeDrawer.addEventListener('click', closeProgressDrawer);
  drawerMask.addEventListener('click', closeProgressDrawer);

  // Swipe navigation (mobile): left=next, right=back
  let touchX=null, touchTime=0;
  document.addEventListener('touchstart', (e)=>{ touchX=e.changedTouches[0].clientX; touchTime=Date.now(); }, {passive:true});
  document.addEventListener('touchend', (e)=>{
    if(touchX===null) return;
    const dx=e.changedTouches[0].clientX - touchX; const dt=Date.now()-touchTime;
    if(dt<600 && Math.abs(dx)>48){
      if(dx<0 && idx<protections.length){ state[protections[idx].id]??='skipped'; idx++; showStep(); } // swipe left → next (skip if undecided)
      if(dx>0 && idx>0){ idx--; showStep(); } // swipe right → back
    }
    touchX=null;
  }, {passive:true});

})();
</script>
</body>
</html>
